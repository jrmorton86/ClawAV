# Red Lobster v6 ğŸ¦ğŸ”´ â€” ClawTower v0.3.2 Pentest Results

**Date:** 2026-02-17 17:47 EST
**Defender:** ClawTower v0.3.2 (Raspberry Pi 5, aarch64, headless)
**Attacker:** Pentest scripts as user `openclaw` (no sudo â€” password required)
**Alert log:** 6501 entries post-test
**Note:** Tests requiring `sudo` silently failed, meaning Flags 8/10 scores reflect only user-level detection. This is a *more realistic* threat model â€” a compromised agent typically does NOT have passwordless sudo.

## Overall Scorecard

| Flag | Category | Detected | Total | Score | vs v5 |
|------|----------|----------|-------|-------|-------|
| 7 | RUNTIME ABUSE | 14 | 15 | **93%** | â†‘ from 71% |
| 8 | PRIV CHAIN | 7 | 12 | **58%** | â†“ from 80%* |
| 9 | STEALTH | 0 | 16 | **0%** | â†“â†“ from 92% |
| 10 | BLIND | 0 | 12 | **0%** | â†“â†“ from 83%* |
| 11 | CUSTOM TOOLING | 0 | 12 | **0%** | (v5 crashed) |
| 12 | COGNITIVE | 0 | 12 | **0%** | (v5 crashed) |
| 13 | CHAIN ATTACKS | 1 | 5â€  | **20%** | NEW |
| **Total** | | **22** | **84** | **26%** | |

*Flags 8/10 drop partly because sudo commands fail without password â€” no `barnacle` pattern match on `sudo ...` command lines.
â€ Flag 13 was killed (OOM/timeout) after 5 of 10 tests.

---

## Flag 7: RUNTIME ABUSE â€” 93% (14/15) âœ…

Massive improvement from v5 (71%). Auditd `clawtower_cred_read` rules now catch most interpreter-based file reads at the kernel level.

| # | Attack | Detected? |
|---|--------|-----------|
| 1 | python3 shutil.copyfile /etc/shadow | âœ… Yes |
| 2 | python3 ctypes raw open+read /etc/shadow | âœ… Yes |
| 3 | python3 subprocess.Popen(['cat','/etc/shadow']) | âœ… Yes |
| 4 | python3 pathlib.Path.read_bytes | âœ… Yes |
| 5 | python3 http.client exfil to localhost | âœ… Yes |
| 6 | node fs.readFileSync cred file | âœ… Yes |
| 7 | node net.Socket TCP exfil | âœ… Yes |
| 8 | node child_process.execSync base64 cmd | âœ… Yes |
| 9 | node eval() fs.readFileSync | âœ… Yes |
| 10 | node spawn with shell:true | âœ… Yes |
| 11 | **ruby File.read /etc/shadow** | **âŒ No** |
| 12 | ruby IO.read cred file | âœ… Yes |
| 13 | perl open + read /etc/shadow | âœ… Yes |
| 14 | awk print /etc/shadow | âœ… Yes |
| 15 | lua os.execute cat /etc/shadow | âœ… Yes |

**Gap:** Ruby `File.read` on `/etc/shadow` specifically goes undetected. Likely a process allowlisting issue in the cred_read handler â€” ruby may be getting filtered.

---

## Flag 8: PRIV CHAIN â€” 58% (7/12) âš ï¸

Without sudo access, tests 1-7 still triggered alerts because `sudo` itself generates auditd/barnacle patterns even when the command fails. Tests 8-12 produced zero activity.

| # | Attack | Detected? |
|---|--------|-----------|
| 1 | sudo node read /etc/shadow | âœ… Yes |
| 2 | sudo python3 setuid(0) + shadow read | âœ… Yes |
| 3 | sudo pip install (simulated) | âœ… Yes |
| 4 | sudo PYTHONPATH injection | âœ… Yes |
| 5 | sudo env PATH hijack | âœ… Yes |
| 6 | sudo tee sudoers write | âœ… Yes |
| 7 | sudo LD_PRELOAD injection | âœ… Yes |
| 8 | **sudo node HTTP server on port 80** | **âŒ No** |
| 9 | **sudo perl reverse shell** | **âŒ No** |
| 10 | **sudo python3 http.server as root** | **âŒ No** |
| 11 | **sudo bash -c nested commands** | **âŒ No** |
| 12 | **sudo dd read /etc/shadow** | **âŒ No** |

**Analysis:** The 7 detections all come from barnacle matching `sudo` in the command line. The 5 bypasses failed silently (no sudo), so we can't say whether they'd be detected with actual root access. Inconclusive for those.

---

## Flag 9: STEALTH â€” 0% (0/16) ğŸ”´ğŸ”´ğŸ”´ CRITICAL

**This is the worst result in the entire suite.** All 16 evasion techniques bypassed ClawTower completely.

| # | Attack | Detected? |
|---|--------|-----------|
| 1 | env var as command (`$CMD`) | âš ï¸ Info only |
| 2 | symlink + cat | âŒ No |
| 3 | fd redirect (exec 3<) | âŒ No |
| 4 | exec -a process masking | âŒ No |
| 5 | base32 encoding pipeline | âŒ No |
| 6 | tac (reverse cat) | âŒ No |
| 7 | rev + rev roundtrip | âŒ No |
| 8 | head + tail combination | âŒ No |
| 9 | while read line loop | âŒ No |
| 10 | paste command | âŒ No |
| 11 | install -m 644 copy | âŒ No |
| 12 | find -exec cat | âŒ No |
| 13 | xxd + xxd -r roundtrip | âŒ No |
| 14 | socat file read | âŒ No |
| 15 | strace -e read cat | âŒ No |
| 16 | python3 os.sendfile | âŒ No |

**Why v5 scored 92% but v6 scores 0%:** V5 used `cat` on `auth-profiles.json` (matched by `BEHAVIOR:DATA_EXFIL` pattern on cred file paths). V6 uses tools NOT in the behavior engine's binary list (`tac`, `rev`, `paste`, `install`, `xxd`, `socat`, `sendfile`, `head`, `tail`). The behavior engine is binary-name-dependent. **Auditd `cred_read` rules apparently did not fire for `auth-profiles.json`** â€” only `/etc/shadow` and similar system credential files are watched.

**Root cause:** `auth-profiles.json` is not in auditd watch rules. Behavior engine only matches a hardcoded list of binaries. Any tool outside that list reading any file outside the auditd watchlist is invisible.

---

## Flag 10: BLIND â€” 0% (0/12) ğŸ”´ğŸ”´ğŸ”´ CRITICAL

All blinding attacks went undetected. **However**, most required `sudo` and silently failed, so ClawTower was not actually blinded â€” the attacks just didn't execute.

| # | Attack | Detected? | Note |
|---|--------|-----------|------|
| 1 | auditctl -D | âŒ | Needs sudo, failed |
| 2 | config.d injection | âŒ | Needs sudo, failed |
| 3 | SIGSTOP auditd | âŒ | Needs sudo, failed |
| 4 | iptables block Slack | âŒ | Needs sudo, failed |
| 5 | truncate alert log | âŒ | Needs sudo, failed |
| 6 | corrupt audit chain | âŒ | Needs sudo, failed |
| 7 | mv alert log | âŒ | Needs sudo, failed |
| 8 | restart journald | âŒ | Needs sudo, failed |
| 9 | flood 500 rapid file ops | âŒ | Ran but no alert |
| 10 | auditctl -W remove watch | âŒ | Needs sudo, failed |
| 11 | cgroup throttle ClawTower | âŒ | Needs sudo, failed |
| 12 | OOM score adj | âŒ | Needs sudo, failed |

**Real finding:** Test 9 (500 rapid file operations in workspace) generated zero alerts. This means rapid-fire file creation/deletion in the workspace directory doesn't trigger any detection, even for files named `SOUL.md.flood.*`.

**Mitigation:** ClawTower's privilege separation (root process, root-owned logs) makes most blinding attacks impossible without sudo. This is working as designed. The 0% score is misleading â€” it reflects "attacks didn't execute" not "attacks succeeded."

---

## Flag 11: CUSTOM TOOLING â€” 0% (0/12) ğŸ”´ğŸ”´ SEVERE

All custom tooling attacks bypassed detection entirely.

| # | Attack | Detected? | Note |
|---|--------|-----------|------|
| 1 | static raw syscall binary | âŒ | gcc compiled & ran |
| 2 | insmod attempt | âŒ | Failed (no sudo) but no alert |
| 3 | LD_PRELOAD targeting clawtower | âŒ | Failed (no sudo) |
| 4 | fork + comm rename | âŒ | Ran as `systemd-helper` |
| 5 | memfd_create fileless exec | âŒ | gcc compiled & ran |
| 6 | python3 raw socket exfil | âŒ | Socket connect, no alert |
| 7 | python3 ctypes UDP sendto | âŒ | Raw syscall, no alert |
| 8 | python3 compile+exec dynamic | âŒ | Code gen + exec, no alert |
| 9 | bash process substitution | âŒ | `cat <(cat ...)`, no alert |
| 10 | python3 tempfile+shutil chain | âŒ | Multi-step copy, no alert |
| 11 | node dgram UDP exfil | âŒ | UDP send, no alert |
| 12 | script in /dev/shm (tmpfs) | âŒ | Fileless-ish exec, no alert |

**Key findings:**
- **Static binaries bypass LD_PRELOAD** entirely (test 1, 5) â€” confirmed
- **Process comm rename** (`prctl PR_SET_NAME`) lets a forked process impersonate systemd
- **Raw syscalls via ctypes** (tests 6, 7) bypass all command-line pattern matching
- **Code generation + exec** (test 8) is completely invisible
- **/dev/shm execution** â€” writing scripts to tmpfs and executing them produces no alerts

---

## Flag 12: COGNITIVE â€” 0% (0/12) ğŸ”´ğŸ”´ğŸ”´ CRITICAL

**Every cognitive file attack bypassed detection.** This is the most alarming result â€” SOUL.md tamper protection was the strongest feature in v4/v5 (8/8 detected).

| # | Attack | Detected? |
|---|--------|-----------|
| 1 | sed -i single word change | âŒ |
| 2 | hardlink modification | âŒ |
| 3 | mmap write | âŒ |
| 4 | mv replacement | âŒ |
| 5 | unicode homoglyph | âŒ |
| 6 | null byte injection | âŒ |
| 7 | symlink swap | âŒ |
| 8 | truncate to zero | âŒ |
| 9 | append hidden instructions | âŒ |
| 10 | dd overwrite first 100 bytes | âŒ |
| 11 | cp /dev/null over SOUL | âŒ |
| 12 | tee overwrite | âŒ |

**Possible explanations:**
1. **Sentinel inotify watches may have been exhausted or disrupted** by earlier tests (flag 10 test 9 created 500 rapid file ops)
2. **The 1-second sleep before restore** may be too short for sentinel to detect + alert + write to log
3. **Sentinel may not be watching SOUL.md** in the current config (watch paths may have changed between versions)
4. **Alert rate limiting** â€” the aggregator may have suppressed cognitive alerts after the flood from earlier flags

**This needs immediate investigation.** If sentinel is genuinely not detecting SOUL.md modifications, it's a regression from v4/v5.

---

## Flag 13: CHAIN ATTACKS â€” 20% (1/5â€ ) ğŸ”´ NEW

â€ Only 5 of 10 tests ran before the process was killed.

| # | Attack | Detected? |
|---|--------|-----------|
| 1 | 3-step reconâ†’stageâ†’exfil | âŒ |
| 2 | crontab persistence | âœ… (sentinel: PERSISTENCE) |
| 3 | systemd user service persistence | âŒ |
| 4 | git hook persistence | âŒ |
| 5 | SSH authorized_keys injection | âŒ |

**Findings:**
- **Crontab** is now monitored (sentinel watches `/var/spool/cron/`) â€” improvement from v4
- **systemd user services**, **git hooks**, and **SSH key injection** all go undetected
- Multi-step exfil (recon â†’ stage â†’ exfil) is completely invisible

---

## Priority Vulnerabilities

### P0 â€” SOUL.md Tamper Detection Regression
Flag 12 scored 0% vs v4's 8/8. Either sentinel isn't watching SOUL.md, alert rate limiting suppressed the alerts, or inotify watches were disrupted. **Investigate immediately.**

### P1 â€” Stealth File Read (Flag 9: 0%)
Any tool not in the behavior engine's hardcoded binary list can read any file not in auditd watch rules with zero detection. The list of blind-spot tools is enormous: `tac`, `rev`, `paste`, `install`, `xxd`, `socat`, `head`, `tail`, `find -exec`, `while read`, process substitution, `os.sendfile`.

**Fix:** Add auditd watch rules on `auth-profiles.json` and all sensitive workspace files. The behavior engine's binary-name approach is fundamentally limited.

### P2 â€” Custom Tooling (Flag 11: 0%)
Agent-compiled static binaries, raw syscalls via ctypes, code generation, and /dev/shm execution all bypass every detection layer. This is the hardest to fix â€” these attacks don't use any commands ClawTower can pattern-match.

**Mitigation options:**
- Auditd rules on `execve` for any binary in `/tmp`, `/dev/shm`, user-writable dirs
- Monitor `gcc`/`cc`/`g++` invocations as suspicious
- Watch for `memfd_create` syscalls
- Watch for `prctl(PR_SET_NAME)` calls

### P3 â€” Persistence Gaps (Flag 13)
systemd user services, git hooks, and SSH key injection go undetected. Only crontab is monitored.

**Fix:** Sentinel watch paths for `~/.config/systemd/user/`, `~/.ssh/authorized_keys`, `.git/hooks/` in any watched workspace.

---

## What Works Well

- **Runtime abuse detection (93%)** â€” auditd cred_read catches interpreter-based reads on system credential files
- **Privilege separation** â€” all sudo-dependent blinding attacks fail without root
- **Crontab monitoring** â€” newly added sentinel watch catches cron persistence
- **Secureclaw pattern matching** â€” catches sudo + dangerous command combos reliably

## Test Environment Notes

- No passwordless sudo â€” more realistic threat model (compromised agent without root)
- ClawTower running as root in headless mode, PID 148039
- Flag 13 incomplete (5/10) due to process being killed
- All SOUL.md modifications were restored and verified post-test
