# ClawAV Example Sentinel Configuration (YAML reference only)
#
# ⚠️  NOTE: ClawAV uses TOML for its config file (/etc/clawav/config.toml), NOT YAML.
# This file is a reference showing sentinel watch_paths structure.
# Convert to TOML format before using. See config.toml for the actual config.

sentinel:
  enabled: true
  watch_paths:
    - path: "/home/openclaw/.openclaw/workspace"
      patterns: ["SOUL.md", "IDENTITY.md", "AGENTS.md", "USER.md", "TOOLS.md", "HEARTBEAT.md"]
      policy: protected
    - path: "/home/openclaw/.openclaw/workspace"
      patterns: ["MEMORY.md"]
      policy: watched
    - path: "/etc"
      patterns: ["passwd", "shadow", "sudoers", "ssh/sshd_config"]
      policy: protected
    - path: "/home/openclaw"
      patterns: [".bashrc", ".profile", ".ssh/authorized_keys"]
      policy: protected
  quarantine_dir: "/etc/clawav/quarantine"
  shadow_dir: "/etc/clawav/sentinel-shadow"
  debounce_ms: 200
  scan_content: true
  max_file_size_kb: 1024

# ── OpenClaw Security Integration ────────────────────────────────────
# Monitors OpenClaw configuration and infrastructure for security issues.
openclaw:
  enabled: true
  # config_path: "/home/openclaw/.openclaw/openclaw.json"
  # state_dir: "/home/openclaw/.openclaw"
  # audit_command: "openclaw security audit --deep"
  audit_on_scan: true           # Run openclaw security audit during periodic scans
  config_drift_check: true      # Detect security regressions in OpenClaw config
  # baseline_path: "/etc/clawav/openclaw-config-baseline.json"
  mdns_check: true              # Check for mDNS info leaks
  plugin_watch: true            # Monitor OpenClaw extensions directory
  session_log_audit: true       # Auditd rules for session log access
